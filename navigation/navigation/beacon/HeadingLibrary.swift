//
//  HeadingLibrary.swift
//  navigation
//
//  Created by 郑旭 on 2021/1/26.
//

import Foundation

class HeadingLibrary {
    static var onePair:Bool = false
    static var StreetHeadingLib:[[Double]] = [
            //New test Lamp 20200726
            [23000001.0, 23000002.0, 59.18429],
            [23000002.0, 23000001.0, 239.18429],
            //Shing Kai Road
            [40450001.0, 40450002.0, 177.18444331570532],
            [40450002.0, 40450001.0, 357.1844433157053],
            [40450002.0, 40450003.0, 173.3928666977784],
            [40450003.0, 40450002.0, 353.3928666977784],
            [40450003.0, 40450004.0, 177.24991482514852],
            [40450004.0, 40450003.0, 357.2499148251485],
            [40450004.0, 40450005.0, 176.43846691103346],
            [40450005.0, 40450004.0, 356.43846691103346],
            [40450005.0, 40450006.0, 173.48019824823552],
            [40450006.0, 40450005.0, 353.4801982482355],
            [40450006.0, 40450007.0, 173.6328201358005],
            [40450007.0, 40450006.0, 353.6328201358005],
            [40450007.0, 40450008.0, 175.86532862642733],
            [40450008.0, 40450007.0, 355.8653286264273],
            [40450008.0, 40450009.0, 182.74808817994727],
            [40450009.0, 40450008.0, 2.748088179947274],

            [40450010.0, 40450011.0, 179.55063055139667],
            [40450011.0, 40450010.0, 359.5506305513967],
            [40450011.0, 40450012.0, 179.52054860131554],
            [40450012.0, 40450011.0, 359.52054860131557],
            [40450012.0, 40450013.0, 180.47155955396772],
            [40450013.0, 40450012.0, 0.4715595539677224],
            [40450013.0, 40450014.0, 180.0],
            [40450014.0, 40450013.0, 360.0],
            [40450014.0, 40450015.0, 182.3532968661666],
            [40450015.0, 40450014.0, 2.353296866166602],
            [40450015.0, 40450016.0, 182.29979942178983],
            [40450016.0, 40450015.0, 2.299799421789828],
            [40450016.0, 40450017.0, 182.83666010107143],
            [40450017.0, 40450016.0, 2.8366601010714305],
            [40450017.0, 40450018.0, 182.48955292194196],
            [40450018.0, 40450017.0, 2.4895529219419643],
            [40450018.0, 40450019.0, 182.42633583160472],
            [40450019.0, 40450018.0, 2.4263358316047174],
            [40450019.0, 40450020.0, 183.57633437499734],
            [40450020.0, 40450019.0, 3.5763343749973444],

            //Sheung Yuet Road
            [40650010.0, 40650012.0, 264.4775181849982],//E7701E7703
            [40650012.0, 40650010.0, 84.47751818499822],
            [40650011.0, 40650013.0, 264.6636799027573],//E7702E7704
            [40650013.0, 40650011.0, 84.66367990275728],
            [40650014.0, 40650016.0, 264.3442222292092],//E7707E7709
            [40650016.0, 40650014.0, 84.34422222920921],
            [40650015.0, 40650017.0, 264.5130535607648],//E7708E7710
            [40650017.0, 40650015.0, 84.51305356076477],
            [40650013.0, 40650015.0, 264.57678140322264],//E7704E7708
            [40650015.0, 40650013.0, 84.57678140322267],
            [40650004.0, 40650006.0, 262.6319489283876],//E7689E7691
            [40650006.0, 40650004.0, 82.63194892838757],
            [40650005.0, 40650007.0, 263.10391580538993],//E7690E7692
            [40650007.0, 40650005.0, 83.10391580538995],
            [40650005.0, 40650003.0, 83.01894259],//E7690E7688
            [40650003.0, 40650005.0, 263.01894259],
            [40650018.0, 40650008.0, 265.00791883],//E8450E7697
            [40650008.0, 40650018.0, 85.00791883],
            [40650002.0, 40650009.0, 263.52098178],//AB3072E7698
            [40650009.0, 40650002.0, 83.52098178],
            [40660003.0, 40650001.0, 263.08877288],//E7685AB1558
            [40650001.0, 40660003.0, 83.08877288],
            [40660004.0, 40650003.0, 264.51384357],//E7686E7688
            [40650003.0, 40660004.0, 84.51384357],
            [40660005.0, 40660001.0, 263.60762632],//GF0709AA6337
            [40660001.0, 40660005.0, 83.60762632],
            [40660006.0, 40660002.0, 261.17521579],//GF0710AA6338
            [40660002.0, 40660006.0, 81.17521579],
    ]

    static func StreetHeading(_ key:Int64) ->[Int64:Double] {
        let Key = Double(key) * 1.0
        var HeadingResult = [Int64:Double]()

        let row = StreetHeadingLib.count
        for i in 0..<row {
            if (abs(StreetHeadingLib[i][0] - Key) < 0.5) {
                let NearKey = StreetHeadingLib[i][1]//正在靠近的灯柱ID
                let Azimuth = StreetHeadingLib[i][2]
                let tempKey = Int64(NearKey)
                HeadingResult[tempKey] = Azimuth
            }

        }
        return HeadingResult
    }
    static func findBeacon(_ weakHeading:Double) ->[Double]{
        let heading = weakHeading

        let row = StreetHeadingLib.count
        var beaconMinor = [Double](repeating: 0.0, count: 2)
        for i in 0..<row {
            if (abs(StreetHeadingLib[i][2] - heading) < 0.00005) {
                beaconMinor[0] = StreetHeadingLib[i][0]//
                beaconMinor[1] = StreetHeadingLib[i][1]
                break
            }
        }
        return beaconMinor
    }
}
